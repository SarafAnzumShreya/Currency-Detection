<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Currency Detection App</title>
    <script src="https://cdn.jsdelivr.net/npm/onnxjs@1.9.0/dist/onnx.min.js"></script>  <!-- Include ONNX.js from CDN -->
</head>
<body>
    <h1>Currency Detection App</h1>
    
    <!-- Video feed -->
    <img id="video-feed" src="{{ url_for('video_feed') }}" alt="Video feed">

    <script>
        // Initialize ONNX.js
        const onnxSession = new onnx.InferenceSession();

        // Load the model (from Flask)
        async function loadModel() {
            await onnxSession.loadModel("{{ url_for('serve_model') }}");  // Fetch the model from Flask
            console.log("Model loaded successfully.");
        }

        loadModel();

        // Process frames from the video feed
        async function detectCurrency(frame) {
            // Convert the video frame to tensor
            const tensor = new onnx.Tensor(frame, 'float32', [1, 3, 224, 224]);  // Adjust dimensions as needed
            
            // Run the inference
            const output = await onnxSession.run([tensor]);
            
            // Process the output to display results (you can adjust this based on your model's output format)
            const outputTensor = output.values().next().value;
            const result = outputTensor.data;

            // Handle the result (e.g., display detection results, play sound, etc.)
            console.log(result);
        }
    </script>
</body>
</html>
