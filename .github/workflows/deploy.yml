name: Deploy to Hugging Face

on:
  push:
    branches:
      - main  # Runs on push to main branch

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repo
        uses: actions/checkout@v2

      - name: Set up Hugging Face token
        run: echo "HF_TOKEN=${{ secrets.HFDEPLOYTOKEN }}" >> $GITHUB_ENV  # Load token into environment

      - name: Clone Hugging Face Space repo
        run: |
          git clone https://huggingface.co/spaces/SarafAnzumShreya/EchoCash
          cd EchoCash  # Make sure to enter the correct directory for your Hugging Face space

      - name: Sync and commit changes to Hugging Face
        run: |
          # Use rsync to sync files, excluding the .git folder
          rsync -av --exclude='.git' ../ .  # Sync your local changes to Hugging Face space
          
          # Set Git user information
          git config --global user.email "sasshreya2001@gmail.com"
          git config --global user.name "SarafAnzumShreya"
          
          git add.
          git commit -m "Auto-deploy from GitHub"
          
          # Push changes to Hugging Face
          git push --force https://SarafAnzumShreya:$HF_TOKEN@huggingface.co/spaces/SarafAnzumShreya/EchoCash main
